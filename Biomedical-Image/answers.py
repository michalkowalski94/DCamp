#EX1
# Import ImageIO
import imageio

# Load "chest-220.dcm"
im = imageio.imread("chest-220.dcm")

# Print image attributes
print('Image type:', type(im))
print('Shape of image array:', im.shape)


#########################################################################
#EX2

# Import ImageIO and load image
import imageio
im = imageio.imread("chest-220.dcm")

# Print the available metadata fields
print(im.meta.keys())


#########################################################################
#EX3

# Import ImageIO
import imageio
im = imageio.imread('chest-220.dcm')

# Print the available metadata fields
print(im.meta.keys())


#########################################################################
#EX4

# Import ImageIO and PyPlot 
import imageio 
import matplotlib.pyplot as plt

# Read in "chest-220.dcm"
im = imageio.imread("chest-220.dcm")




#########################################################################
#EX5


# Draw the image in grayscale
plt.imshow(im, cmap='gray')

# Render the image
plt.show()



#########################################################################
#EX6

# Draw the image with greater contrast
plt.imshow(im, cmap='gray', vmin=-200, vmax=200)

# Render the image
plt.show()



#########################################################################
#EX7

# Remove axis ticks and labels
plt.axis('off')

# Render the image
plt.show()



#########################################################################
#EX8

# Import ImageIO and NumPy
import imageio
import numpy as np

# Read in each 2D image
im1 = imageio.imread('chest-220.dcm')
im2 = imageio.imread('chest-221.dcm')
im3 = imageio.imread('chest-222.dcm')

# Stack images into a volume
vol = np.stack((im1,im2,im3), axis=0)
print('Volume dimensions:', vol.shape)



#########################################################################
#EX9

# Import ImageIO
import imageio

# Load the "tcia-chest-ct" directory
vol = imageio.volread('tcia-chest-ct')

# Print image attributes
print('Available metadata:', vol.meta.keys())
print('Shape of image array:', vol.shape)



#########################################################################
#EX10


#(82, 500, 500) (3)

    


#########################################################################
#EX11

# Import PyPlot
import matplotlib.pyplot as plt

# Initialize figure and axes grid
fig, axes = plt.subplots(nrows=2, ncols=1)

# Draw an image on each subplot
axes[0].imshow(im1, cmap='gray')
axes[1].imshow(im2, cmap='gray')

# Remove ticks/labels and render
axes[0].axis('off')
axes[1].axis('off')
plt.show()

#########################################################################
#EX12

# Plot the images on a subplots array 
fig, axes = plt.subplots(nrows= 1, ncols= 4)

# Loop through subplots and draw image
for ii in range(4):
    im = vol[40*ii,:,:]
    axes[ii].imshow(im, cmap='gray')
    axes[ii].axis('off')
    
# Render the figure
plt.show()


#########################################################################
#EX13

# Select frame from "vol"
im1 = vol[:, 256, :]
im2 = vol[:,:,256]

# Compute aspect ratios
d0, d1, d2 = vol.meta['sampling']
asp1 = d0 / d2
asp2 = d0 / d1

# Plot the images on a subplots array 
fig, axes = plt.subplots(nrows=2, ncols=1)
axes[0].imshow(im1, cmap='gray', aspect=asp1)
axes[1].imshow(im2, cmap='gray', aspect=asp2)
plt.show()




#########################################################################
#EX14

# Load the hand radiograph
im = imageio.imread("hand-xray.jpg")
print('Data type:', im.dtype)
print('Min. value:', im.min())
print('Max value:', im.max())

# Plot the grayscale image
plt.imshow(im,cmap='gray', vmin=0, vmax=255)
plt.colorbar()
format_and_render_plot()




#########################################################################
#EX15

# Import SciPy's "ndimage" module
import scipy.ndimage as ndi 

# Create a histogram, binned at each possible value
hist = ndi.histogram(im,0,255,256)

# Create a cumulative distribution function
cdf = hist.cumsum() / hist.sum()

# Plot the histogram and CDF
fig, axes = plt.subplots(2, 1, sharex=True)
axes[0].plot(hist, label='Histogram')
axes[1].plot(cdf, label='CDF')
format_and_render_plot()



#########################################################################
#EX16

# Create skin and bone masks
mask_bone = im >= 145
mask_skin = (im>=45) & (im<145)

# Plot the skin (0) and bone (1) masks
fig, axes = plt.subplots(1,2)
axes[0].imshow(mask_skin, cmap='gray')
axes[1].imshow(mask_bone, cmap='gray')
format_and_render_plot()



#########################################################################
#EX17

# Import SciPy's "ndimage" module
import scipy.ndimage as ndi

# Screen out non-bone pixels from "im"
mask_bone = im >= 145
im_bone = np.where(mask_bone == True, im, 0)

# Get the histogram of bone intensities
hist = ndi.histogram(im_bone, 1, 255, 255)

# Plot masked image and histogram
fig, axes = plt.subplots(2,1)
axes[0].imshow(im_bone)
axes[1].plot(hist)
format_and_render_plot()


#########################################################################
#EX18





#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
#EX



#########################################################################
